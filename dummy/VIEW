CREATE VIEW GOLD.DIM_CUSTOMER  AS
       SELECT 
        ROW_NUMBER() OVER (ORDER BY CUST_ID) AS CUSTOMER_KEY
        ,CI.CUST_ID AS CUSTOMER_ID
       ,CI.CST_KEY AS CUSTOMER_NUMBER
       ,CI.CST_FIRSTNAME AS FIRST_NAME
       ,CI.CST_LASTNAME AS LAST_NAME
       ,LA.CNTRY AS COUNTRY
       ,CI.CST_MATERIAL_STATUS AS MARTIAL_STATUS
       ,CASE WHEN CI.CST_GNDR!='n/a' THEN CI.CST_GNDR
                         ELSE COALESCE(CA.GEN,'n/a') END AS GENDER
       ,CI.CST_CREATE_DATE AS CREATE_DATE
       ,CA.BDATE AS BIRTH_DATE
       
       
    FROM SILVER.CRM_CUST_INFO CI
    LEFT JOIN SILVER.ERP_LOC_AZ12 CA
    ON CI.CST_KEY=CA.CID
    LEFT JOIN SILVER.ERP_LOC_A101 LA
    ON CI.CST_KEY=LA.CID;
